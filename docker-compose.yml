services:
  api:
    image: registry.digitalocean.com/sequenced-registry/sequenced-api:latest
    platform: linux/amd64
    environment:
      APP_URL: https://sequenced.ottegi.com
      SESSION_SECRET: change-me
      DATABASE_URL: mongodb://mongo:27017/sequenced
      PORT: 8080
    depends_on:
      - mongo
    restart: unless-stopped
    ports:
      - "127.0.0.1:8080:8080"

  frontend:
    image: registry.digitalocean.com/sequenced-registry/sequenced-frontend:latest
    platform: linux/amd64
    depends_on:
      - api
    restart: unless-stopped
    ports:
      - "127.0.0.1:4173:80"

  mongo:
    image: mongo:7
    platform: linux/amd64
    command: ["mongod", "--auth"]
    volumes:
      - mongo-data:/data/db
    restart: unless-stopped

volumes:
  mongo-data:
