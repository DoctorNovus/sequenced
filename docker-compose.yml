services:
  mongo:
    image: mongo:7
    platform: linux/amd64
    volumes:
      - mongo-data:/data/db

  api:
    image: registry.digitalocean.com/sequenced-registry/sequenced-api:latest
    platform: linux/amd64
    environment:
      APP_URL: https://sequenced.ottegi.com
      SESSION_SECRET: change-me
      DATABASE_URL: mongodb://mongo:27017/sequenced
      PORT: 8080
    depends_on:
      - mongo
    restart: unless-stopped

  frontend:
    image: registry.digitalocean.com/sequenced-registry/sequenced-frontend:latest
    environment:
        # Build-time API endpoint baked into the Vite bundle.
        VITE_API_URL: https://api.sequenced.ottegi.com
    platform: linux/amd64
    depends_on:
      - api
    restart: unless-stopped

volumes:
  mongo-data:
